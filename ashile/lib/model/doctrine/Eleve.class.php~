<?php

/**
 * Eleve
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ash
 * @subpackage model
 * @author     regis Gravant
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class Eleve extends BaseEleve
{
  static public function capitalize($field){  //mettre en majuscule
 setlocale(LC_CTYPE, 'fr_FR.UTF8');
return mb_strtoupper($field, 'UTF-8'); }
  
  
  
    public function getOrientationValid()
    {
       $orientations = $this->getOrientation();
       $count = count($orientations);
       $debutAnneeScolaire = Doctrine::getTable('AnneeScolaire')->getAnneeScolaireEnCours()->getDatedebutanneescolaire();
       
       if($count > 0){
			foreach ($orientations as $orientation){
				
				if(isset($orientation['datedebut']) && $orientation['datedebut'] >= $debutAnneeScolaire){
						return $orientation;
				}
 			}
		}
        return null;
    }
    
    public function getEtabsco()
    {
        $orientation = $this->getOrientationValid();
        
        return $orientation ? $orientation->getEtabsco() : null;
    }
	 
	 public function __toString()
	 {    
	     if($this->getSecteurId()){
	     $libellesecteur  = Doctrine::getTable('Secteur')->findOneById($this->getSecteurId())->getLibelleSecteur() ;
		 }else{
		 $libellesecteur ='PAS DE SECTEUR';
		 }
		 return $this->getNom().' '.$this->getPrenom().' né(e) le '.date('d/m/Y',strtotime($this->getDatenaissance())).' - '.$libellesecteur;
	 }
	 
public function getEleveCda() {

   $eleve_cda = Doctrine_Core::getTable('Eleve')->getEleveAvecCDA() ;
   return $this->getNom().'-'.$this->getPrenom().' - CDA du : '.date('d/m/Y',strtotime($this->getDatedecisioncda())).' - matériel demandé : '.$this->getLibelletypemateriel();
}
  
}
